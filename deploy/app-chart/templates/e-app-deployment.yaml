apiVersion: apps/v1
kind: Deployment
metadata:
   name: {{ .Release.Name }}
   labels:
      app: {{ .Release.Name }}
      env: {{ .Values.deployment.env }}
      owner: {{ .Values.deployment.owner }}
spec:
   replicas: {{ .Values.deployment.replicaCount }}
   selector:
      matchLabels:
         app: {{ .Release.Name }}
   template:
      metadata:
         labels:
            app: {{ .Release.Name }}
      spec:
         containers:
            - name: {{ .Release.Name }}
              image: {{ .Values.deployment.container.image }} 
              envFrom:
                 - configMapRef:
                     name: user-service-config
                 - secretRef:
                     name: postgres-secret
              ports:
                 - containerPort: {{ .Values.deployment.port }}

